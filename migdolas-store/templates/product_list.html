{% extends 'base.html' %}
{% load static %}

{% block content %}
<h2 class="mb-4">Mūsų Baldai</h2>

<div class="row">
  <!-- Category Sidebar -->
  <div class="col-md-3 mb-4">
    <h5>Kategorijos</h5>
    <ul class="list-group">
      <li class="list-group-item {% if not category %}active{% endif %}">
        <a href="{% url 'product_list' %}" class="text-decoration-none">Visos</a>
      </li>
      {% for cat in categories %}
        <li class="list-group-item {% if cat == category %}active{% endif %}">
          <a href="{% url 'product_list_by_category' cat.slug %}" class="text-decoration-none">
            {{ cat.name }}
          </a>
        </li>
      {% endfor %}
    </ul>

    <!-- Search Bar -->
    <form id="liveSearchForm" class="mt-4">
      <div class="input-group">
        <input type="text" name="q" id="searchInput" class="form-control" placeholder="Ieškoti baldų...">
      </div>
    </form>
  </div>

  <!-- Product Results Grid -->
  <div class="col-md-9">
    <div class="row" id="productResults">
      {% include 'partials/_product_cards.html' %}
    </div>
  </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
  $('#searchInput').on('input', function () {
    let query = $(this).val();
    $.ajax({
      url: "{% url 'ajax_product_search' %}",
      data: { 'q': query },
      dataType: 'json',
      success: function (data) {
        $('#productResults').html(data.html);
      }
    });
  });
</script>
{% endblock %}